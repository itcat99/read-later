{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/background/index.js"],"names":["OTHER_BOOKMARK_FOLDER_ID","DEFALUT_CONFIG","folder","ReadLater","config","posts","Object","assign","bookmarkApi","search","result","folderArr","forEach","item","parentId","push","length","targetId","id","shift","getChildren","children","child","move","remove","_getInfo","console","log","create","title","chrome","runtime","onMessage","addListener","msg","_updateWithView","bookmarks","onCreated","bookmark","info","_update","onMoved","onRemoved","removeInfo","onChanged","get","bookmarkInfo","onImportEnded","contextMenus","onClicked","checked","tabsApi","query","active","currentWindow","currentTab","url","_popMsg","type","payload","GET_POSTS","_sendMsg","RETURN_POSTS","REMOVE_POST","then","sendMessage","num","browserAction","setBadgeText","text","contexts","message","notifications","iconUrl","setBadgeBackgroundColor","color","_getPosts","_setBadgeNum","_hasFolder","_createFolder","_createContxtMenus","_listener","onInstalled","app","run","catch","err","error"],"mappings":"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","file":"background.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"background\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([\"./src/background/index.js\",\"vendor\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/* eslint no-console:0 */\n\nimport { bookmarkApi, tabsApi } from \"../chromeApi\";\nimport { GET_POSTS, RETURN_POSTS, REMOVE_POST } from \"../constents\";\n\nconst OTHER_BOOKMARK_FOLDER_ID = \"2\";\nconst DEFALUT_CONFIG = {\n  folder: \"__read_later__\",\n};\n\nclass ReadLater {\n  constructor(config) {\n    this.posts = [];\n    this.config = Object.assign({}, DEFALUT_CONFIG, config);\n  }\n\n  async _getInfo(folder) {\n    const result = await bookmarkApi.search(folder);\n    const folderArr = [];\n\n    result.forEach(item => {\n      const { parentId } = item;\n\n      if (parentId === OTHER_BOOKMARK_FOLDER_ID) {\n        folderArr.push(item);\n      }\n    });\n\n    if (folderArr.length === 1) {\n      return folderArr[0];\n    } else {\n      const targetId = folderArr[0].id;\n      folderArr.shift();\n\n      folderArr.forEach(async item => {\n        const { id } = item;\n        const children = await bookmarkApi.getChildren(id);\n        children.forEach(async child => {\n          await bookmarkApi.move(child.id, {\n            parentId: targetId,\n          });\n        });\n\n        await bookmarkApi.remove(id);\n      });\n\n      return this._getInfo(targetId);\n    }\n  }\n\n  async _hasFolder(folder) {\n    const result = await bookmarkApi.search(folder);\n    console.log(\"has folder result: \", result);\n\n    return result.length > 0;\n  }\n  _createFolder(folder) {\n    return bookmarkApi.create({\n      parentId: OTHER_BOOKMARK_FOLDER_ID,\n      title: folder,\n    });\n  }\n\n  _getPosts(id) {\n    return bookmarkApi.getChildren(id);\n  }\n\n  _listener() {\n    chrome.runtime.onMessage.addListener(msg => {\n      this._updateWithView(msg);\n    });\n\n    /* Following is about bookmark's events */\n    chrome.bookmarks.onCreated.addListener(async (id, bookmark) => {\n      if (bookmark.parentId === this.info.id) {\n        await this._update();\n      }\n    });\n    chrome.bookmarks.onMoved.addListener(async () => {\n      await this._update();\n    });\n    chrome.bookmarks.onRemoved.addListener(async (id, removeInfo) => {\n      if (removeInfo.parentId === this.info.id) {\n        await this._update();\n      }\n    });\n    chrome.bookmarks.onChanged.addListener(async id => {\n      const bookmarkInfo = await bookmarkApi.get(id);\n      if (bookmarkInfo.parentId === this.info.id) {\n        await this._update();\n      }\n    });\n    chrome.bookmarks.onImportEnded.addListener(async () => {\n      await this._update();\n    });\n\n    /* with contextMenus */\n    chrome.contextMenus.onClicked.addListener(async () => {\n      let checked = true;\n      const result = await tabsApi.query({\n        active: true,\n        currentWindow: true,\n      });\n      const currentTab = result[0];\n      this.posts.forEach(item => {\n        if (item.url === currentTab.url) {\n          checked = false;\n        }\n      });\n\n      if (!checked) {\n        this._popMsg(\"error\", \"has the same post.\");\n        return false;\n      }\n\n      await bookmarkApi.create({\n        parentId: this.info.id,\n        title: currentTab.title,\n        url: currentTab.url,\n      });\n\n      this._update();\n      this._popMsg(\"success\", \"add a read later post.\");\n    });\n  }\n\n  _updateWithView(msg) {\n    const { type, payload } = msg;\n\n    switch (type) {\n      case GET_POSTS:\n        this._sendMsg({ type: RETURN_POSTS, payload: this.posts });\n        break;\n      case REMOVE_POST:\n        bookmarkApi.remove(payload).then(async () => {\n          await this._update();\n          this._sendMsg({ type: RETURN_POSTS, payload: this.posts });\n        });\n        break;\n      default:\n        return;\n    }\n  }\n\n  _sendMsg(msg) {\n    chrome.runtime.sendMessage(msg);\n  }\n\n  _setBadgeNum(num = 0) {\n    if (num > 99) {\n      num = \"99+\";\n    }\n\n    chrome.browserAction.setBadgeText({\n      text: num + \"\",\n    });\n  }\n\n  _createContxtMenus() {\n    chrome.contextMenus.create({\n      title: \"read later\",\n      id: \"read-later-contextMenus\",\n      contexts: [\"page\"],\n    });\n  }\n\n  _popMsg(title, message) {\n    chrome.notifications.create({\n      iconUrl: \"./icons/icon_128.png\",\n      type: \"basic\",\n      title,\n      message,\n    });\n  }\n\n  _setBadgeColor() {\n    chrome.browserAction.setBadgeBackgroundColor({\n      color: \"#4779ED\",\n    });\n  }\n\n  async _update() {\n    this.posts = await this._getPosts(this.info.id);\n    this._setBadgeNum(this.posts.length);\n  }\n\n  async run() {\n    const { folder } = this.config;\n\n    if (!(await this._hasFolder(folder))) {\n      await this._createFolder(folder);\n    }\n\n    this.info = await this._getInfo(folder);\n    await this._update();\n\n    this._createContxtMenus();\n    this._listener();\n  }\n}\n\nchrome.runtime.onInstalled.addListener(() => {\n  const app = new ReadLater();\n\n  app\n    .run()\n    .then(() => {\n      console.log(\"> app is running...\");\n    })\n    .catch(err => {\n      console.error(\"> app start has Err: \", err);\n    });\n});\n"],"sourceRoot":""}