webpackJsonp([1],{

/***/ 3:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
var _config=__webpack_require__(0),_config2=_interopRequireDefault(_config);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var info={},postList=[];build().then(function(a){info=a,updatePostList(a),setbadge()}),createContxtMenus(),listener();function build(){return new Promise(function(a){chrome.bookmarks.search({title:_config2.default.title},function(b){b.length?function(){concatDir(b),a(info)}():chrome.bookmarks.create({title:_config2.default.title},function(b){a(b)})})})}function createContxtMenus(){chrome.contextMenus.create({title:'read later',contexts:['page'],onclick:addPost})}function listener(){chrome.runtime.onMessage.addListener(function(a){var b=a.type,c=a.data;update(b,c)}),chrome.commands.onCommand.addListener(function(a){'add-new-post'===a&&addPost()})}function updatePostList(a){chrome.bookmarks.getChildren(a.id,function(a){postList=a})}function setbadge(){chrome.bookmarks.getChildren(info.id,function(a){var b;b=a?a.length:0,chrome.browserAction.setBadgeText({text:99<b?'+'+b:''+b})})}function createDir(){return new Promise(function(a){chrome.bookmarks.create({title:_config2.default.title},function(b){a(b)})})}function concatDir(a){var b=a[0].id;info=Object.assign({},a[0]),a.shift(),a.forEach(function(a){chrome.bookmarks.getChildren(a.id,function(c){c.forEach(function(a){chrome.bookmarks.move(a.id,{parentId:b})}),chrome.bookmarks.remove(a.id)})})}function createMark(a,b){var c={parentId:info.id,title:a,url:b};chrome.bookmarks.create(c,function(){return popMsg('success','add a read later post.')})}function removeMark(a){chrome.bookmarks.remove(a,popMsg('success','remove post.'))}function popMsg(a,b){chrome.notifications.create({iconUrl:'./icons/icon_128.png',type:'basic',title:a,message:b})}function addPost(){chrome.tabs.query({active:!0,currentWindow:!0},function(a){if(1===a.length){var b=a[0],c=b.title,d=b.url,e=!0,f=!1,g=void 0;try{for(var h,i,j=postList[Symbol.iterator]();!(e=(h=j.next()).done);e=!0)if(i=h.value,i.url===d)return!1}catch(a){f=!0,g=a}finally{try{!e&&j.return&&j.return()}finally{if(f)throw g}}createMark(c,d),setbadge()}else throw'add post ERROR'})}function update(a,b){'remove'===a&&removeMark(b),'clear'===a&&clearPost(),'get_data'===a&&chrome.runtime.sendMessage({type:'return_data',data:info}),setbadge()}function clearPost(){chrome.bookmarks.removeTree(info.id),chrome.runtime.reload()}

/***/ })

},[3]);