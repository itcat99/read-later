webpackJsonp([1],{154:function(e,t,o){"use strict";var r,n=o(69),i=(r=n)&&r.__esModule?r:{default:r};var a,c={},s=[],m=i.default,u=m.title;function d(e){chrome.bookmarks.getChildren(e.id,function(e){s=e})}function f(){chrome.bookmarks.getChildren(c.id,function(e){var t;t=e?e.length:0,chrome.browserAction.setBadgeText({text:t>99?"+"+t:""+t})})}function h(e,t){chrome.notifications.create({iconUrl:"./icons/icon_128.png",type:"basic",title:e,message:t})}function l(){chrome.tabs.query({active:!0,currentWindow:!0},function(e){if(1!==e.length)throw"add post ERROR";var t=e[0];!function(e,t){var o={parentId:c.id,title:e,url:t},r=!0,n=!0,i=!1,a=void 0;try{for(var m,u=s[Symbol.iterator]();!(n=(m=u.next()).done);n=!0)m.value.url===t&&(r=!1)}catch(e){i=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}if(!r)return h("warning","you has the same post."),!1;chrome.bookmarks.create(o,function(e){d(c),h("success","add a read later post.")})}(t.title,t.url),f()})}(a=u,new Promise(function(e,t){chrome.bookmarks.search({title:a},function(t){t.length?(function(e){var t=e[0].id;c=Object.assign({},e[0]),e.shift(),e.forEach(function(e){chrome.bookmarks.getChildren(e.id,function(o){o.forEach(function(e){chrome.bookmarks.move(e.id,{parentId:t})}),chrome.bookmarks.remove(e.id)})})}(t),e(c)):chrome.bookmarks.create({title:a},function(t){e(t)})})})).then(function(e){c=e,d(e),f()}),chrome.contextMenus.create({title:"read later",contexts:["page"],onclick:l}),chrome.runtime.onMessage.addListener(function(e){var t=e.type,o=e.data;!function(e,t){var o;"remove"===e&&(o=t,s.forEach(function(e,t){e.id===o&&s.splice(t,1)}),chrome.bookmarks.remove(o,function(){d(c),h("success","remove post.")})),"clear"===e&&(chrome.bookmarks.removeTree(c.id),chrome.runtime.reload(),c={},s=[]),"get_data"===e&&chrome.runtime.sendMessage({type:"return_data",data:c}),"get_settings"===e&&chrome.runtime.sendMessage({type:"return_settings",data:m}),"reset_settings"!==e&&"save_settings"!==e||function(e,t){var o=void 0;t&&t.title!==u&&(o=!0),m="reset_settings"===e?i.default:t,o&&(u=m.title,chrome.bookmarks.update(c.id,{title:u}))}(e,t),f()}(t,o)}),chrome.commands.onCommand.addListener(function(e){"add-new-post"===e&&l()})}},[154]);