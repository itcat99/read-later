!function(t){function e(e){for(var r,i,o=e[0],c=e[1],u=e[2],h=0,p=[];h<o.length;h++)i=o[h],a[i]&&p.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);for(f&&f(e);p.length;)p.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={2:0},s=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var f=c;s.push([55,0]),n()}({55:function(t,e,n){"use strict";n.r(e);var r=n(7),a=n.n(r),s=n(16),i=n.n(s),o=n(8),c=n.n(o),u=n(9),f=n.n(u),h=n(10),p=n.n(h),l=n(24);function d(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return new Promise(function(e,r){try{var a;(a=chrome.bookmarks)[t].apply(a,n.concat([function(t){e(t)}]))}catch(t){r(t)}})}function v(t,e){chrome.notifications.create({iconUrl:"./icons/icon_128.png",type:"basic",title:t,message:e})}function g(t,e){chrome.runtime.sendMessage({type:t,payload:e})}var m=n(5),k=function(){function t(e){var n=this;c()(this,t),p()(this,"addPost",function(){chrome.tabs.query({active:!0,currentWindow:!0},function(){var t=i()(a.a.mark(function t(e){var r,s,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.length){t.next=5;break}r=e[0],s=r.title,i=r.url,n.createMark(s,i),t.next=6;break;case 5:throw new Error("add post ERROR");case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}())}),this.cacheConfig=e,this.config=e,this.folderName=this.config.title,this.info={},this.posts=[],this.init().then(function(){n.createContxtMenus(),n.listener()})}return f()(t,[{key:"init",value:function(){var t=i()(a.a.mark(function t(){var e,n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getFolder(this.folderName);case 2:if(!(e=t.sent)||!e.length){t.next=12;break}return t.t0=Object,t.t1={},t.next=8,this.concatDir(e);case 8:t.t2=t.sent,n=t.t0.assign.call(t.t0,t.t1,t.t2),t.next=18;break;case 12:return t.t3=Object,t.t4={},t.next=16,this.createFolder(this.folderName);case 16:t.t5=t.sent,n=t.t3.assign.call(t.t3,t.t4,t.t5);case 18:return this.info=Object.assign({},this.info,n),t.next=21,this.getPosts(this.info.id);case 21:this.posts=t.sent,this.setBadgeNum(this.info,this.posts),this.setBadgeColor();case 24:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"listener",value:function(){var t=this;chrome.runtime.onMessage.addListener(function(e){var n=e.type,r=e.payload;t.update(n,r)}),chrome.commands.onCommand.addListener(function(e){e===m.a&&t.addPost()})}},{key:"createMark",value:function(){var t=i()(a.a.mark(function t(e,n){var r,s,i,o,c=arguments;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:this.info,s=c.length>3&&void 0!==c[3]?c[3]:this.posts,i={parentId:r.id,title:e,url:n},o=!0,s.forEach(function(t){t.url===n&&(o=!1)}),o){t.next=8;break}return v("warning","you has the same post."),t.abrupt("return",!1);case 8:return t.next=10,d("create",i);case 10:return t.next=12,this.getPosts(this.info.id);case 12:return this.posts=t.sent,t.next=15,this.setBadgeNum(this.info,this.posts);case 15:v("success","add a read later post.");case 16:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"concatDir",value:function(){var t=i()(a.a.mark(function t(e){var n,r,s,i,o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.length){t.next=2;break}return t.abrupt("return",e[0]);case 2:n=e[0].id,r=Object.assign({},e[0]),e.shift(),t.t0=a.a.keys(e);case 6:if((t.t1=t.t0()).done){t.next=23;break}return s=t.t1.value,t.next=10,d("getChildren",e[s].id);case 10:i=t.sent,t.t2=a.a.keys(i);case 12:if((t.t3=t.t2()).done){t.next=18;break}return o=t.t3.value,t.next=16,d("move",i[o].id,{parentId:n});case 16:t.next=12;break;case 18:return t.next=20,d("remove",e[s].id);case 20:return t.abrupt("return",r);case 23:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"getPosts",value:function(){var t=i()(a.a.mark(function t(e){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d("getChildren",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"getFolder",value:function(){var t=i()(a.a.mark(function t(e){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d("search",{title:e});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createFolder",value:function(){var t=i()(a.a.mark(function t(e){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d("create",{title:e});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"setBadgeNum",value:function(t,e){if(!t.id)return chrome.browserAction.setBadgeText({text:"0"}),!1;var n=e.length;chrome.browserAction.setBadgeText({text:n>99?"+".concat(n):"".concat(n)})}},{key:"setBadgeColor",value:function(){chrome.browserAction.setBadgeBackgroundColor({color:"#4779ED"})}},{key:"update",value:function(t,e){switch(t){case m.e:this.removeMark(e);break;case m.b:this.clear();break;case m.c:g(m.g,this.posts);break;case m.d:g(m.h,this.config);break;case m.k:case m.f:this.updateSettings(t,e,this.info)}}},{key:"removeMark",value:function(){var t=i()(a.a.mark(function t(e){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d("remove",e);case 2:return t.next=4,this.getPosts(this.info.id);case 4:this.posts=t.sent,this.setBadgeNum(this.info,this.posts),v("success","remove post.");case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"clear",value:function(){var t=i()(a.a.mark(function t(){var e,n,r=arguments;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=r.length>0&&void 0!==r[0]?r[0]:this.posts,t.prev=1,t.t0=a.a.keys(e);case 3:if((t.t1=t.t0()).done){t.next=9;break}return n=t.t1.value,t.next=7,d("remove",e[n].id);case 7:t.next=3;break;case 9:this.posts=[],this.setBadgeNum(this.info,this.posts),t.next=16;break;case 13:throw t.prev=13,t.t2=t.catch(1),new Error(t.t2);case 16:case"end":return t.stop()}},t,this,[[1,13]])}));return function(){return t.apply(this,arguments)}}()},{key:"updateSettings",value:function(){var t=i()(a.a.mark(function t(e,n){var r,s=arguments;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=s.length>2&&void 0!==s[2]?s[2]:this.info,e===m.f?this.config=this.cacheConfig:this.config=Object.assign({},this.config,n),this.folderName=this.config.title,d("update",r.id,{title:this.folderName});case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"createContxtMenus",value:function(){chrome.contextMenus.create({title:"read later",contexts:["page"],onclick:this.addPost})}}]),t}();chrome.browserAction.setPopup({popup:"./popup.html"}),new k(l.a)}});